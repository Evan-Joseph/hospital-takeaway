# 产品需求文档 (PRD) - 码上购医疗便民订购平台

## 1. 修订历史

| 版本号 | 修订日期       | 修订人  | 修订内容      |
| --- | ---------- | ---- | --------- |
| 1.1 | 2025-08-18 | 产品经理 | 完整PRD文档制定 |

## 2. 项目概述

### 2.1 项目背景

为满足日益增长的本地化服务需求，我们计划打造一个连接本地商家与顾客的综合性服务平台。当前，项目需求信息分散于各类沟通记录中，缺乏统一、明确的指导性文档。本PRD旨在将所有已知需求进行系统性整合，为设计、开发、测试等后续环节提供清晰、无歧义的行动指南，确保项目高效、准确地推进。

### 2.2 产品目标

* **对于顾客**：提供一个简洁、流畅的线上购物体验，能够方便地浏览商家、下单购买、并实时跟踪订单状态。

* **对于商家**：提供一套易于上手的后台管理工具，支持商品管理、订单处理、优惠活动设置等核心功能，提升经营效率。

* **对于平台**：建立一个稳定、可控的管理后台，实现对平台用户、内容和核心业务数据的有效监控与管理。

## 3. 用户画像与场景

### 3.1 顾客 (Customer)

**画像描述**：追求便捷线上服务的本地消费者，熟悉移动支付和在线购物流程。

**核心诉求**：

* 快速找到附近的商家和商品

* 下单、支付流程简单快捷

* 能清楚地了解自己的订单进展

* 个人信息和收货地址管理方便

### 3.2 商家 (Merchant)

**画像描述**：希望拓展线上业务的本地实体店主（如餐饮、零售等），需要简单高效的工具来管理线上订单和店铺。

**核心诉求**：

* 轻松发布和管理自己的商品菜单

* 实时接收新订单并进行处理

* 对账流程清晰，能快速确认收款

* 灵活设置促销活动吸引顾客

### 3.3 超级管理员 (Super Admin)

**画像描述**：平台的运营和管理者，负责维护平台的正常运转、用户管理和内容审核。

**核心诉求**：

* 全面掌控平台的用户数据（顾客与商家）

* 能够管理平台内容，如首页轮播图和系统公告

* 监控平台整体运营数据，如总营业额

* 对商家资质进行审核与管理

## 4. 功能性需求

### 4.1 通用与认证模块

#### 4.1.1 用户注册 (P0)

**用户故事**：作为一个新用户（顾客或商家），我希望通过手机号快速完成注册，以便开始使用平台。

**业务规则**：

* 注册时仅需提供手机号，账户立即创建，无需即时短信验证

* 国家区号默认为中国大陆（+86）

* 顾客注册流程：输入手机号 -> 设置姓名与密码

* 商家注册流程：输入手机号 -> 设置密码 -> 填写商家信息（店铺信息）

**验收标准**：

* 用户输入手机号和密码后，系统数据库中成功创建对应角色的用户账户

* 商家注册时，能成功提交店铺信息

#### 4.1.2 用户登录 (P0)

**用户故事**：作为一个已注册用户，我希望能通过手机号和密码安全地登录我的账户。

**业务规则**：

* 顾客和商家均使用手机号和密码登录

* 超级管理员使用独立的认证方式：仅密码登录。首次登录需初始化设置密码

**验收标准**：

* 用户输入正确的手机号和密码后，能成功登录并访问相应权限的界面

* 商家登录后，应直接跳转至商家后台管理界面

* 超级管理员输入正确密码后，能成功登录后台

#### 4.1.3 密码与手机号管理 (P1)

**用户故事**：作为一个用户，我希望在需要时可以安全地修改我的密码或手机号。

**业务规则**：

* 仅在用户发起"修改密码"或"更改手机号"操作时，系统才向其手机号发送短信验证码进行身份验证

* 需集成真实的手机号验证服务

**验收标准**：

* 用户点击修改密码/手机号时，能收到验证码短信

* 输入正确的验证码后，用户可以设置新的密码/手机号

### 4.2 顾客端 (主要为竖屏设计)

#### 4.2.1 首页 (P0)

**用户故事**：作为一个顾客，我希望在首页能看到平台的最新活动和核心信息，并快速开始浏览。

**业务规则**：

* 顶部应包含一个功能正常的轮播图模块

* 轮播图下方新增一个"问候区"，用于展示用户最近一笔订单的核心信息，包括：商家名称、下单时间、订单金额、以及商品摘要（如"XX商品 等X件"）

* 移除所有特点卡片（如"扫码点餐"、"商家入驻"等静态入口）

* 首页应只保留一个个人中心的入口

**验收标准**：

* 首页轮播图可以正常展示和切换

* 问候区能正确显示指定的订单信息

* 特点卡片已被移除

* 个人中心入口唯一

#### 4.2.2 购物流程 (P0)

**用户故事**：作为一个顾客，我希望能流畅地浏览商品、加入购物车、下单并完成支付。

**业务规则**：

* **浏览**：用户可以浏览不同商家的店铺主页及其商品列表

* **购物车**：

  * 支持将不同商家的商品加入购物车

  * 购物车内商品按商家进行分组

  * 结算时，不同商家的商品需分开结算，生成独立的订单

* **下单与支付**：

  * **填写信息**：下单时，姓名和手机号根据用户信息自动填充；收货地址应自动填充用户设置的默认地址，并支持从已保存地址列表中选择或手动输入

  * **支付流程**：

    * 下单后，页面自动跳转至支付页

    * 支付页展示商家设置的收款码图片，以及一个与该订单绑定的随机数字验证码

    * 顾客需手动截图/保存收款码，使用第三方支付工具（如微信/支付宝）扫描支付，并在支付备注中填写平台生成的验证码

    * 顾客手动操作完成后，需在平台上手动将订单状态更新为"已付款"

  * **页面跳转逻辑**：下单 -> 自动跳转支付页 -> 支付操作完成后 -> 自动跳转订单详情页

**验收标准**：

* 购物车能正确按商家对商品进行分组

* 下单时收货信息能正确自动填充和选择

* 下单后能看到包含收款码和验证码的支付页面

* 页面跳转逻辑符合：下单 -> 支付 -> 订单详情

#### 4.2.3 订单管理 (P0)

**用户故事**：作为一个顾客，我希望能随时查看我的订单状态，了解配送进度，并确认收货。

**业务规则**：

* 顾客可以查看自己的历史订单列表

* 订单状态会实时更新，顾客可以监控从"商家配送中"到"顾客已收货"的全过程

* 顾客在收到商品后，可手动将订单状态更新为"已确认收货"

**验收标准**：

* 订单列表能正确显示所有历史订单

* 当商家更新订单状态时，顾客端能实时或准实时地看到变化

* 顾客可以成功执行"确认收货"操作

#### 4.2.4 个人中心 (P1)

**用户故事**：作为一个顾客，我希望有一个个人中心页面来管理我的个人信息和收货地址。

**业务规则**：

* 支持修改用户姓名

* 支持修改/绑定手机号（需短信验证）

* 支持修改密码（需短信验证）

* 支持管理收货地址列表（增/删/改），并能设置一个默认收货地址

**验收标准**：

* 所有信息修改功能均可正常使用

* 设置的默认收货地址在下单时能被正确引用

### 4.3 商家端 (支持竖屏和横屏设计)

#### 4.3.1 店铺与商品管理 (P0)

**用户故事**：作为一个商家，我希望能方便地管理我的店铺信息、菜单、收款码和优惠活动。

**业务规则**：

* **店铺信息管理**：支持修改店铺名称、地址、联系方式等基本信息

* **菜单管理**：

  * 支持商品信息的增、删、改、查

  * 支持商品图片的上传与管理

  * 允许商家自定义菜单分组（如"热销推荐"、"主食"、"饮品"）

  * 商品品类需按生活领域进行分类，并提供"其他"选项

* **收款码管理**：支持商家上传和更新用于收款的二维码图片

* **优惠活动管理**：

  * 支持创建、修改、删除优惠活动

  * 优惠类型需足够灵活，支持按商品分组设置、按特定商品设置，以及"满X减Y"等多种模式

  * 设置的优惠活动需在顾客端正常展示和应用

**验收标准**：

* 商家可以成功上传图片并关联到商品或收款码

* 商家可以自定义菜单分组

* 商家创建的优惠活动能在顾客端生效

#### 4.3.2 订单处理 (P0)

**用户故事**：作为一个商家，我需要一个高效的订单处理系统，能实时接收新订单，快速确认收款并安排配送。

**业务规则**：

* **实时听单**：商家后台需具备订单实时监听功能，新订单进入时应有明显提示

* **订单处理流程优化**：

  * **待确认收款**：对于状态为"顾客称已支付"的订单，界面需优先、突出显示"付款验证码"和"订单金额"，方便商家核对

  * **确认收款**：商家核对无误后，点击"确认收款"，订单状态立即更新为"商家已确认收款/商家配送中"

  * **配货**：确认收款后，界面应突出显示顾客购买的商品列表，方便商家配货

  * **开始配送**：商家点击"配送中"按钮后，订单状态更新

  * **等待收货**：配送中状态后，订单信息以常规方式展示，等待顾客确认收货

**验收标准**：

* 新订单能实时推送到商家后台

* 订单处理界面的信息展示优先级和状态流转符合上述业务规则

### 4.4 超级管理员端 (支持竖屏和横屏设计)

#### 4.4.1 用户管理 (P1)

**用户故事**：作为一个管理员，我需要能够管理平台上的所有顾客和商家账户。

**业务规则**：

* **顾客管理**：支持查看、搜索、禁用/启用顾客账户

* **商家管理**：

  * 支持查看、搜索商家账户及店铺信息

  * **商家状态管理**：商家账户应有三种状态："待审核"、"已激活"、"已封停"

  * "已激活"和"已封停"的商家不应计入"待审核"的统计提示中

**验收标准**：

* 管理员可以对顾客和商家账户进行管理操作

* 商家状态流转和后台统计显示正确

#### 4.4.2 内容管理 (P0)

**用户故事**：作为一个管理员，我需要管理平台首页的轮播图和发布系统公告。

**业务规则**：

* **轮播图管理**：支持对首页轮播图的增、删、改、排序

* **公告管理**：

  * 必须实现真实数据逻辑，而非模拟数据

  * 支持公告的发布、修改、删除

  * 发布公告时，可以选择发布对象，支持多选（如同时向顾客和商家发布）

**验收标准**：

* 轮播图管理功能可正常使用，且修改后在顾客端首页生效

* 公告可以成功发布给指定角色的用户

#### 4.4.3 数据监控 (P2)

**用户故事**：作为一个管理员，我希望能查看平台的关键业务数据，以了解运营状况。

**业务规则**：

* 后台首页或数据看板应展示平台总营业额等核心指标

* 超级管理员应能查看所有商家的优惠活动设置情况

**验收标准**：

* 核心业务数据能正确展示

### 4.5 核心业务流程：订单状态与支付

#### 4.5.1 订单状态机 (P0)

订单生命周期应包含以下5种核心状态：

* **待支付**：顾客下单后，订单初始状态

* **顾客称已支付**：顾客在支付页完成线下支付操作后，手动更新的状态

* **超时关闭**："待支付"状态的订单在30分钟后未完成支付，系统自动关闭

* **商家已确认收款/商家配送中**：商家核对收款信息（验证码）无误后，确认收款并开始备货配送。此为合并后的单一状态

* **顾客已确认收货**：顾客收到商品后，手动确认，订单完成

**全局支付倒计时**：所有"待支付"状态的订单，从创建开始计时，30分钟内未支付则自动流转至"超时关闭"状态。

## 5. 非功能性需求

### 5.1 UI/UX 体验

* **界面风格**：整体设计应简洁大方，所有页面进行UI/UX统一化设计，尽可能使用统一的UI控件和布局风格

* **响应式布局**：确保所有界面在目标设备（顾客端-竖屏；商家/管理端-竖屏和横屏）上都能良好地响应式展示

* **导航逻辑**：

  * 状态栏左侧的"返回"按钮功能统一为模拟系统返回键的行为

  * 优化应用内导航逻辑，避免出现页面循环跳转

* **一致性**：商家详情页等所有页面的状态栏样式需与应用整体设计风格保持一致

* **信息展示**：在购物车、订单页等所有显示商家信息的地方，必须显示商家名称（name），而非商家ID

* **评价系统**：彻底移除所有与评价系统相关的UI元素

### 5.2 性能

* **实时性**：商家端的订单监听功能需保证低延迟，确保新订单能被及时接收

* **页面加载**：各页面加载速度应进行优化，避免出现长时间白屏或卡顿

### 5.3 安全性

* **数据访问**：根据项目要求，在数据访问控制方面，优先考虑使用较宽松的行级安全（RLS）策略，或不使用RLS，以保障系统稳定性和用户体验。在必须使用RLS的场景（如超级管理员公告管理），需仔细检查配置，确保功能权限正常。

